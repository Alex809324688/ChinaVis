<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
	<style type="text/css">
		*{
			margin: 0;
			padding: 0;
		}
		#container{
			margin: 15px auto;
			background: #dcdcdc;
			width: 500px;
			height: 20px;
			border-radius: 3px;
		}
		#control{
			display: inline-block;
			width: 10px;
			height: 28px;
			background: rgb(128,128,128);
			position: relative;
			border-radius: 2px;
			left: 0;
			top: 0;
			margin-top:-4px; 
		}
	</style>
</head>
<body>
	<div id="container">
		<div id="control"></div>
	</div>
	<script>
		var bfb;
		var drag = function (obj1,obj3) {//obj1，obj3是jQuery对象。obj1是子元素的jQuery对象，obj3是父元素的jQuery对象。
		    var x;
		    var y;
		    var gapX;
		    var gapY;
		    obj1.mousedown(start);
		    function start(event) {
		        if (event.button == 0) {//判断是否点击鼠标左键
		            gapX = event.clientX - obj1.offset().left + obj3.offset().left;//这是计算在减去鼠标相对于子元素的偏移量后，父元素相对于屏幕的横向距离。
		            gapY = event.clientY - obj1.offset().top + obj3.offset().top;//与gapX同理
		            //movemove事件必须绑定到$(document)上，鼠标移动是在整个屏幕上的
		            $(document).mousemove(move);
		            //此处的$(document)可以改为obj
		            $(document).mouseup(stop);
		        }

		    }
		    function move(event) {
		    	bfb = parseFloat(((obj1.offset().left-obj3.offset().left)/(obj3[0].offsetWidth - obj1[0].offsetWidth)).toFixed(2));
		        x = event.clientX - gapX;//用鼠标相对于屏幕的横向距离减去父元素相对于屏幕的横向距离
				if(x < 0) {//限制obj1移出obj3左端
				        x = 0;
				 }
				 //限制obj1移出obj3的右端
				else if(x > (obj3[0].offsetWidth - obj1[0].offsetWidth)) {
				    x = obj3[0].offsetWidth - obj1[0].offsetWidth;
				}
				
				obj1.css({
				    "left": x + "px"
				});
		    }
		    function stop(){
		        //解绑定，这一步很必要，前面有解释
		        $(document).unbind("mousemove", move);
		        $(document).unbind("mouseup", stop);

		    }  
		};
		var son = $("#control");
		var parent = $("#container");
		drag(son,parent);
	</script>
</body>
</html>
